#' @title
#' Write data frame
#' @description
#' Functions to write data frames to plain text delimited files
#' while retaining factor levels
#' @usage
#' x_write(x, x_name, file_path = "new.csv")
#' @param x
#' a data frame.
#' @param x_name
#' path to store the file of the data frame.
#' @param file_path
#' path to store the companion file.

#' @return
#' \code{x_write()} returns nothing.
#' \code{x_read()} returns a data frame read from files.
#' An error is raised if the input is not a dataframe, or files not found.
#' @rdname x_read_write
#' @export

x_write <- function(x, x_name, file_path = NA) {
  # check if the input is a factor or not
  if (!is.data.frame(x)) {
    stop("This is not a data frame")
  }
  # write data frame using write_csv()
  readr::write_csv(x, x_name)
  # get names of columns of factors
  factor_cols <- names(Filter(is.factor, x))
  # write levels to companion file
  # use lapply() and levels() to get levels of factor columns
  dput(lapply(x[factor_cols], levels), file_path)
}
